<!DOCTYPE html>
<html>
<head>
    <title>Ranking Rally</title>
    <style>
        body { font-family: sans-serif; display: flex; justify-content: space-around; background: #f4f4f4; }
        .col { width: 45%; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background: #34495e; color: white; }
        tr:nth-child(even) { background: #f9f9f9; }
    </style>
</head>
<body>

<div class="col">
    <h2>Categoria 4x4</h2>
    <table id="t4x4">
        <thead><tr><th>Pos</th><th>Carro</th><th>Piloto</th><th>Pontos</th></tr></thead>
        <tbody></tbody>
    </table>
</div>

<div class="col">
    <h2>Categoria 4x2</h2>
    <table id="t4x2">
        <thead><tr><th>Pos</th><th>Carro</th><th>Piloto</th><th>Pontos</th></tr></thead>
        <tbody></tbody>
    </table>
</div>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
<script>
    const firebaseConfig = { /* MESMA CONFIG */ };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    db.ref('competidores').on('value', snap => {
        const lista = [];
        snap.forEach(c => { lista.push(c.val()); });

        // Ordenar Decrescente (Quem tem mais pontos ganha)
        lista.sort((a, b) => b.pontos - a.pontos);

        render(lista.filter(c => c.categoria === '4x4'), 't4x4');
        render(lista.filter(c => c.categoria === '4x2'), 't4x2');
    });

    function render(dados, tableId) {
        const tbody = document.querySelector(`#${tableId} tbody`);
        tbody.innerHTML = dados.map((c, i) => `
            <tr>
                <td>${i+1}ยบ</td>
                <td>${c.numero}</td>
                <td>${c.nome}</td>
                <td>${c.pontos.toLocaleString()}</td>
            </tr>
        `).join('');
    }
</script>
</body>
</html>
